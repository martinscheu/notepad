<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>notes</title>
  <link rel="stylesheet" href="/static/styles.css" />
  
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='18' fill='%23809398'/><text x='50' y='64' text-anchor='middle' font-size='60' fill='white' font-family='Arial, Helvetica, sans-serif'>n</text></svg>">
</head>
<body>
  <div class="topbar">
    <div class="topbar-left">
      <div class="brand">notes</div>
      <button id="fileViewToggle" class="btn btn-ghost btn-small">Focus</button>
      <input id="search" class="input" type="text" placeholder="Search (Ctrl+K)" autocomplete="off" />
      
    </div>

    <div class="topbar-right">
      <div class="note-actions-top" id="noteActionsTop">
        <div class="action-group">
          <button id="newNote" class="btn">New</button>
          <button id="uploadNote" class="btn">Upload</button>
        </div>
        <div class="action-group">
          <button id="previewToggle" class="btn">Preview</button>
        </div>
        <div class="action-group">
          <button id="renameNote" class="btn">Rename</button>
          <button id="pinNote" class="btn">Pin</button>
          <div class="dropdown" id="downloadDropdown">
            <button id="downloadBtn" class="btn">Download</button>
            <div class="dropdown-menu hidden">
              <button class="dropdown-item" id="downloadNote">File (.md)</button>
              <button class="dropdown-item" id="pdfNote">PDF</button>
              <button class="dropdown-item" id="copyLink">Copy link</button>
            </div>
          </div>
        </div>
        <div class="action-group">
          <div class="dropdown" id="moreDropdown">
            <button id="moreBtn" class="btn">More</button>
            <div class="dropdown-menu hidden">
              <button class="dropdown-item" id="replaceBtn">Replace</button>
              <button class="dropdown-item" id="tocToggle">Table of contents</button>
              <button class="dropdown-item" id="metadataBtn">Document metadata</button>
              <div class="dropdown-item" style="display:flex; align-items:center; gap:6px;">
                <span class="muted small">Format</span>
                <select id="previewFormat" class="select" aria-label="Preview format">
                  <option value="md">Markdown</option>
                  <option value="txt">Text</option>
                  <option value="json">JSON</option>
                  <option value="yaml">YAML</option>
                </select>
              </div>
            </div>
          </div>
          <button id="syncBtn" class="btn">Settings</button>
        </div>
      </div>
    </div>
  </div>

  <input id="uploadInput" type="file" accept=".md,.txt" multiple style="display:none" />

  <div class="layout">
    <div class="sidebar">
      <div class="sidebar-head">
        <div class="muted" id="notesCount">Notes</div>
        <div class="muted" id="statusLine">Idle</div>
      </div>
      <div class="bulk-actions">
      <select id="sort" class="select" aria-label="Sort">
        <option value="updated">Sort: Updated</option>
        <option value="created">Sort: Created</option>
        <option value="filename">Sort: Filename</option>
      </select>
        <button id="selectAll" class="btn">Select all</button>
        <button id="selectNone" class="btn">Select none</button>
        <button id="downloadSelected" class="btn">Download selected</button>
        <button id="deleteSelected" class="btn danger">Delete selected</button>
      </div>
      <div id="notesList" class="notes-list"></div>
    </div>

    <div id="splitter" class="splitter" title="Drag to resize"></div>

    <div class="main">
      <div class="tabsbar">
        <div id="tabsBar" class="tabs"></div>
<div class="save-indicator">
          <div id="saveState" class="muted">Idle</div>
          <div id="saveTime" class="muted"></div>
        </div>
      </div>

      <div class="editorbar">
        <div class="fileline">
          <div class="label muted">File</div>
          <div id="fileName" class="filename">-</div>
          <div id="tlpBadge" class="tlp-badge hidden" title="TLP classification">TLP: AMBER</div>
          <div id="encryptedBadge" class="encrypted-badge hidden">Encrypted</div>
        </div>
      </div>
      <div class="editor-area">
        <div id="tocPanel" class="toc-panel hidden" aria-label="Table of contents">
          <div class="panel-header">
            <div class="panel-title">Contents</div>
            <select id="tocDepth" class="select" aria-label="TOC depth">
              <option value="1">H1</option>
              <option value="2">H1–H2</option>
              <option value="3" selected>H1–H3</option>
              <option value="4">H1–H4</option>
              <option value="5">H1–H5</option>
              <option value="6">H1–H6</option>
            </select>
          </div>
          <div id="tocList" class="toc-list"></div>
        </div>
        <div class="editor-stack">
          <div id="preview" class="preview" style="display:none;"></div>
          <div id="editorHighlight" class="editor-highlight" aria-hidden="true"></div>
          <textarea id="editor" class="editor" placeholder="Select a note from the left or create a new one"></textarea>
        </div>

        <div id="replace-panel" class="replace-panel hidden" aria-label="Search and replace panel">
          <div class="panel-header">
            <div class="panel-title">Search &amp; Replace</div>
            <button id="replace-close" class="btn btn-ghost" title="Close">Close</button>
          </div>
          <div class="panel-body">
            <label class="field">
              <div class="field-label">Find</div>
              <input id="replace-find" class="input" type="text" autocomplete="off" />
            </label>
            <label class="field">
              <div class="field-label">Replace with</div>
              <input id="replace-with" class="input" type="text" autocomplete="off" />
            </label>
            <div class="row">
              <label class="check"><input id="replace-matchcase" type="checkbox" /> Match case</label>
              <label class="check"><input id="replace-wholeword" type="checkbox" /> Whole word</label>
            </div>
            <div class="muted small" id="replace-count">0 matches</div>
            <div id="replace-status" class="muted small"></div>
          </div>
          <div class="panel-footer">
            <button id="replace-find-next" class="btn" title="Find next">Find next</button>
            <button id="replace-next" class="btn" title="Replace next">Replace next</button>
            <button id="replace-all" class="btn" title="Replace all">Replace all</button>
          </div>
        </div>
      </div>

      
<div class="help muted">
  <div class="footer-line">
    Shortcuts: Ctrl+N new, Ctrl+K search, Ctrl+H replace, Ctrl+Shift+R rename, Ctrl+X close tab, Esc clear search.
  </div>
  <div class="footer-line">
    Sync: <span id="footerSyncSummary">disabled</span>
  </div>
  <div class="footer-line">
    Version: 1.1.63
  </div>
</div>

    </div>
  </div>

  <div class="modal hidden" id="syncModal" aria-hidden="true">
    <div class="modal-backdrop" data-close="sync"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="syncTitle">
      <div class="modal-header">
        <div class="modal-title" id="syncTitle">Settings</div>
        <button class="btn btn-small" id="syncCloseBtn">Close</button>
      </div>

      <div class="modal-body" style="display:block; max-height:calc(100vh - 180px); overflow-y:auto;">

        <div class="settings-section collapsed" id="preferencesSection">
          <div class="settings-section-header" data-toggle="preferencesSection">
            <span class="settings-section-title" style="margin:0;">Preferences</span>
            <span class="settings-section-caret">▼</span>
          </div>
          <div class="settings-section-body">
            <div class="grid-2">
              <div class="form-row">
                <label>Theme</label>
                <select id="settingsTheme" class="select">
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                </select>
              </div>
              <div class="form-row">
                <label>Tab sorting</label>
                <select id="settingsTabSort" class="select">
                  <option value="fixed">Classic</option>
                  <option value="mru">Most Recently Used</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <div class="settings-section collapsed" id="defaultsSection">
          <div class="settings-section-header" data-toggle="defaultsSection">
            <span class="settings-section-title" style="margin:0;">Document Defaults</span>
            <span class="settings-section-caret">▼</span>
          </div>
          <div class="settings-section-body">
            <div class="form-row">
              <div class="muted small">Pre-fill these values when opening Rename &amp; Metadata on a new note.</div>
            </div>
            <div class="grid-2">
              <div class="form-row">
                <label>Author</label>
                <input type="text" id="defaultAuthor" autocomplete="off">
              </div>
              <div class="form-row">
                <label>Company</label>
                <input type="text" id="defaultCompany" autocomplete="off">
              </div>
            </div>
            <div class="form-row">
              <label>TLP</label>
              <select id="defaultTlp" class="select">
                <option value="CLEAR">CLEAR</option>
                <option value="GREEN">GREEN</option>
                <option value="AMBER" selected>AMBER</option>
                <option value="AMBER+STRICT">AMBER+STRICT</option>
                <option value="RED">RED</option>
              </select>
            </div>
            <div class="settings-btn-row">
              <button class="btn btn-primary" id="saveDefaultsBtn">Save defaults</button>
            </div>
          </div>
        </div>

        <div class="settings-section collapsed" id="syncSection">
          <div class="settings-section-header" data-toggle="syncSection">
            <span class="settings-section-title" style="margin:0;">Sync (WebDAV)</span>
            <span class="settings-section-caret">▼</span>
          </div>
          <div class="settings-section-body">
            <div class="form-row">
              <label class="checkbox">
                <input type="checkbox" id="syncEnabled">
                <span>Enable sync</span>
              </label>
            </div>
            <div class="form-row">
              <label>WebDAV URL</label>
              <input type="text" id="syncUrl" placeholder="https://example.com/remote.php/dav/files/user/" autocomplete="off">
            </div>
            <div class="form-row">
              <label>Remote folder</label>
              <input type="text" id="syncRemotePath" placeholder="stickynotes/notes" autocomplete="off">
            </div>
            <div class="grid-2">
              <div class="form-row">
                <label>Username</label>
                <input type="text" id="syncUser" autocomplete="username">
              </div>
              <div class="form-row">
                <label>Password / Token</label>
                <input type="password" id="syncPass" autocomplete="current-password">
              </div>
            </div>
            <div class="grid-2">
              <div class="form-row">
                <label>Mode</label>
                <select id="syncMode">
                  <option value="push">Push (local -> WebDAV)</option>
                  <option value="pull">Pull (WebDAV -> local)</option>
                  <option value="bisync">Two-way (bisync)</option>
                </select>
              </div>
              <div class="form-row">
                <label>Interval (seconds)</label>
                <input type="number" id="syncInterval" min="10" step="5" value="60">
              </div>
            </div>
            <div class="form-row">
              <label class="checkbox">
                <input type="checkbox" id="syncNoDelete" checked>
                <span>No deletes (safety)</span>
              </label>
            </div>
            <div class="form-row">
              <div class="muted small" id="syncStatus">Status: not configured</div>
            </div>
            <div class="settings-btn-row">
              <button class="btn" id="syncTestBtn">Test connection</button>
              <button class="btn" id="syncRunBtn">Sync now</button>
              <button class="btn" id="pauseSyncBtn">Pause Sync</button>
              <button class="btn btn-primary" id="syncSaveBtn">Save sync settings</button>
            </div>
          </div>
        </div>

        <div class="settings-section collapsed" id="encryptionSection">
          <div class="settings-section-header" data-toggle="encryptionSection">
            <span class="settings-section-title" style="margin:0;">Encryption</span>
            <span class="settings-section-caret">▼</span>
          </div>
          <div class="settings-section-body">

            <!-- State: no key configured -->
            <div id="encryptionSetup">
              <div class="form-row">
                <div class="muted small">Set a passphrase to enable per-note encryption at rest. Back up /config/ to preserve the key.</div>
              </div>
              <div class="form-row">
                <label>Passphrase</label>
                <input type="password" id="encryptionNewPassphrase" placeholder="Enter passphrase" autocomplete="off">
              </div>
              <div class="settings-btn-row">
                <button class="btn" id="encryptionEnableBtn">Enable encryption</button>
              </div>
            </div>

            <!-- State: key configured -->
            <div id="encryptionActive" class="hidden">
              <div class="form-row">
                <div class="muted small" id="encryptionStatus">Encryption enabled</div>
              </div>
              <div class="settings-divider"></div>
              <div class="form-row">
                <div class="muted small" style="font-weight:600; opacity:0.7;">Change passphrase</div>
              </div>
              <div class="grid-2">
                <div class="form-row">
                  <label>Current passphrase</label>
                  <input type="password" id="encryptionCurrentPassphrase" placeholder="Current" autocomplete="off">
                </div>
                <div class="form-row">
                  <label>New passphrase</label>
                  <input type="password" id="encryptionPassphrase" placeholder="New" autocomplete="off">
                </div>
              </div>
              <div class="settings-btn-row">
                <button class="btn" id="encryptionSaveBtn">Change passphrase</button>
              </div>
              <div class="settings-divider"></div>
              <div class="form-row">
                <div class="muted small" style="font-weight:600; opacity:0.7;">Disable encryption</div>
              </div>
              <div class="form-row">
                <div class="muted small">Decrypt all encrypted notes and remove the key.</div>
              </div>
              <div class="form-row">
                <label>Confirm passphrase</label>
                <input type="password" id="encryptionDisablePassphrase" placeholder="Enter current passphrase" autocomplete="off">
              </div>
              <div class="settings-btn-row">
                <button class="btn danger" id="encryptionDisableBtn">Disable encryption</button>
              </div>
            </div>

            <div class="form-row" id="encryptionWarningRow">
              <div class="muted small" style="color: var(--danger);" id="encryptionWarning"></div>
            </div>

          </div>
        </div>

      </div>

      <div class="modal-footer">
        <div></div>
        <button class="btn btn-small" id="syncCloseBtn2">Close</button>
      </div>
    </div>
  </div>


    <!-- Rename Modal -->
    <div id="rename-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="rename-title">
      <div class="modal-card">
        <div class="modal-header">
          <div id="rename-title" class="modal-title">Rename note</div>
          <button id="rename-close" class="btn btn-ghost" title="Close">Close</button>
        </div>

    <div class="modal-body">
      <div id="rename-section">
        <label class="field">
          <div class="field-label">Title</div>
          <input id="rename-input" class="input" type="text" autocomplete="off" />
          <div class="muted small" style="margin-top:6px;">Renaming updates filename and display title.</div>
        </label>
        <label class="field" style="margin-top:14px;">
          <div class="field-label">Subject</div>
          <input id="subject-input" class="input" type="text" autocomplete="off" list="subject-suggestions" />
          <datalist id="subject-suggestions"></datalist>
          <div class="muted small" style="margin-top:6px;">Notes with the same subject are grouped together.</div>
        </label>
      </div>
      <div id="metadata-section">
        <div class="settings-divider"></div>
        <div class="settings-section-title">Document Metadata</div>
        <div class="grid-2">
          <label class="field">
            <div class="field-label">Author</div>
            <input id="pdfAuthor" class="input" type="text" autocomplete="off" />
          </label>
          <label class="field">
            <div class="field-label">Company</div>
            <input id="pdfCompany" class="input" type="text" autocomplete="off" />
          </label>
        </div>
        <div class="grid-2">
          <label class="field">
            <div class="field-label">Version</div>
            <input id="pdfVersion" class="input" type="text" autocomplete="off" placeholder="1.2.0" />
          </label>
          <label class="field">
            <div class="field-label">Date</div>
            <input id="pdfDate" class="input" type="date" />
          </label>
        </div>
        <div class="form-row">
          <label class="checkbox">
            <input type="checkbox" id="pdfUseExportDate" checked>
            <span>Use export date</span>
          </label>
        </div>
        <div class="form-row">
          <label>TLP</label>
          <select id="pdfTlp" class="select">
            <option value="CLEAR">CLEAR</option>
            <option value="GREEN">GREEN</option>
            <option value="AMBER">AMBER</option>
            <option value="AMBER+STRICT">AMBER+STRICT</option>
            <option value="RED">RED</option>
          </select>
        </div>
        <div class="settings-divider"></div>
        <div class="form-row">
          <label class="checkbox">
            <input type="checkbox" id="noteEncrypted">
            <span>Encrypt this note on disk</span>
          </label>
        </div>
      </div>
    </div>

        <div class="modal-footer">
          <button id="rename-cancel" class="btn" title="Cancel">Cancel</button>
          <button id="rename-save" class="btn btn-primary" title="Save">Save</button>
        </div>
      </div>
    </div>

  <script src="/static/app.js"></script>
</body>
</html>
